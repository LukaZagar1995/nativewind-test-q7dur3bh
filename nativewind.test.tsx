import fs from "node:fs";
import Svg, { Mask, Path, SvgProps } from "react-native-svg";
import { screen, render, cssInterop } from "nativewind/test";
import config from "./tailwind.config";

// This tells NativeWind log information to the console

cssInterop(Svg, {
  className: {
    target: "style",
    nativeStyleToProp: { fill: true },
  },
});

// This is used to identify your component
const testID = "nativewind";
// Load your CSS as text
const css = fs.readFileSync("./global.css", "utf-8");

test("should render your className as props", async () => {
  // Render your component using your custom CSS and tailwind config
  await render(
    <Svg
      width={19}
      height={19}
      viewBox="0 0 19 19"
      className="fill-red-500"
      testID={testID}
    >
      <Mask
        id="a"
        width={17}
        height={17}
        x={1}
        y={1}
        maskUnits="userSpaceOnUse"
      >
        <Path d="M1 1h17v17H1z" />
        <Path d="M8.2 14.402c-.332.337-.665.666-1.012.995a.38.38 0 0 0 0 .497c.347.336.68.673 1.012 1.01a.365.365 0 0 0 .494 0c.333-.33.665-.674.997-1.01a.35.35 0 0 0 0-.497l-.997-.995a.347.347 0 0 0-.247-.107.365.365 0 0 0-.247.107Zm4.195-.864a.357.357 0 0 0-.248.1.35.35 0 0 0-.107.244v1.415c0 .094.037.184.103.252a.364.364 0 0 0 .252.108h1.422a.357.357 0 0 0 .244-.111.35.35 0 0 0 .096-.249v-1.415a.342.342 0 0 0-.1-.241.35.35 0 0 0-.24-.104h-1.422Zm-8.723-1.492a.357.357 0 0 0-.244.11.35.35 0 0 0-.096.25v1.415a.35.35 0 0 0 .34.344h1.445a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.244v-1.416a.358.358 0 0 0-.104-.251.365.365 0 0 0-.252-.108H3.672Zm11.729-2.74c-.333.33-.665.659-.997 1.01a.35.35 0 0 0 0 .498l.997.994a.348.348 0 0 0 .494 0c.332-.336.672-.665 1.012-.994a.38.38 0 0 0 0-.498c-.332-.344-.672-.673-1.012-1.01a.365.365 0 0 0-.255-.106.32.32 0 0 0-.24.107ZM3.1 7.165l-.997 1.041a.35.35 0 0 0 0 .497l.997.995a.332.332 0 0 0 .382.08.332.332 0 0 0 .112-.08c.348-.33.672-.658 1.012-.995a.35.35 0 0 0 0-.497l-1.012-1.04a.38.38 0 0 0-.494 0ZM13.879 4.87a.357.357 0 0 0-.245.111.35.35 0 0 0-.095.249v1.415a.333.333 0 0 0 .208.318.343.343 0 0 0 .132.027H15.3a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.245V5.191a.366.366 0 0 0-.356-.36l-1.421.038ZM5.187 3.34a.357.357 0 0 0-.249.1.35.35 0 0 0-.107.244V5.1a.372.372 0 0 0 .355.36h1.422a.357.357 0 0 0 .244-.112.35.35 0 0 0 .096-.248v-1.4a.343.343 0 0 0-.099-.241.35.35 0 0 0-.24-.104L5.186 3.34Zm5.107-1.232-.99.995a.35.35 0 0 0 0 .497l.99 1.01a.365.365 0 0 0 .51 0c.332-.329.664-.658.996-1.01a.35.35 0 0 0 0-.497l-.996-.995a.365.365 0 0 0-.395-.081.325.325 0 0 0-.115.081Z" />
      </Mask>
      <Path d="M8.2 14.402c-.332.337-.665.666-1.012.995a.38.38 0 0 0 0 .497c.347.336.68.673 1.012 1.01a.365.365 0 0 0 .494 0c.333-.33.665-.674.997-1.01a.35.35 0 0 0 0-.497l-.997-.995a.347.347 0 0 0-.247-.107.365.365 0 0 0-.247.107Zm4.195-.864a.357.357 0 0 0-.248.1.35.35 0 0 0-.107.244v1.415c0 .094.037.184.103.252a.364.364 0 0 0 .252.108h1.422a.357.357 0 0 0 .244-.111.35.35 0 0 0 .096-.249v-1.415a.342.342 0 0 0-.1-.241.35.35 0 0 0-.24-.104h-1.422Zm-8.723-1.492a.357.357 0 0 0-.244.11.35.35 0 0 0-.096.25v1.415a.35.35 0 0 0 .34.344h1.445a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.244v-1.416a.358.358 0 0 0-.104-.251.365.365 0 0 0-.252-.108H3.672Zm11.729-2.74c-.333.33-.665.659-.997 1.01a.35.35 0 0 0 0 .498l.997.994a.348.348 0 0 0 .494 0c.332-.336.672-.665 1.012-.994a.38.38 0 0 0 0-.498c-.332-.344-.672-.673-1.012-1.01a.365.365 0 0 0-.255-.106.32.32 0 0 0-.24.107ZM3.1 7.165l-.997 1.041a.35.35 0 0 0 0 .497l.997.995a.332.332 0 0 0 .382.08.332.332 0 0 0 .112-.08c.348-.33.672-.658 1.012-.995a.35.35 0 0 0 0-.497l-1.012-1.04a.38.38 0 0 0-.494 0ZM13.879 4.87a.357.357 0 0 0-.245.111.35.35 0 0 0-.095.249v1.415a.333.333 0 0 0 .208.318.343.343 0 0 0 .132.027H15.3a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.245V5.191a.366.366 0 0 0-.356-.36l-1.421.038ZM5.187 3.34a.357.357 0 0 0-.249.1.35.35 0 0 0-.107.244V5.1a.372.372 0 0 0 .355.36h1.422a.357.357 0 0 0 .244-.112.35.35 0 0 0 .096-.248v-1.4a.343.343 0 0 0-.099-.241.35.35 0 0 0-.24-.104L5.186 3.34Zm5.107-1.232-.99.995a.35.35 0 0 0 0 .497l.99 1.01a.365.365 0 0 0 .51 0c.332-.329.664-.658.996-1.01a.35.35 0 0 0 0-.497l-.996-.995a.365.365 0 0 0-.395-.081.325.325 0 0 0-.115.081Z" />
      <Path
        strokeWidth={1.4}
        d="M8.2 14.402c-.332.337-.665.666-1.012.995a.38.38 0 0 0 0 .497c.347.336.68.673 1.012 1.01a.365.365 0 0 0 .494 0c.333-.33.665-.674.997-1.01a.35.35 0 0 0 0-.497l-.997-.995a.347.347 0 0 0-.247-.107.365.365 0 0 0-.247.107Zm4.195-.864a.357.357 0 0 0-.248.1.35.35 0 0 0-.107.244v1.415c0 .094.037.184.103.252a.364.364 0 0 0 .252.108h1.422a.357.357 0 0 0 .244-.111.35.35 0 0 0 .096-.249v-1.415a.342.342 0 0 0-.1-.241.35.35 0 0 0-.24-.104h-1.422Zm-8.723-1.492a.357.357 0 0 0-.244.11.35.35 0 0 0-.096.25v1.415a.35.35 0 0 0 .34.344h1.445a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.244v-1.416a.358.358 0 0 0-.104-.251.365.365 0 0 0-.252-.108H3.672Zm11.729-2.74c-.333.33-.665.659-.997 1.01a.35.35 0 0 0 0 .498l.997.994a.348.348 0 0 0 .494 0c.332-.336.672-.665 1.012-.994a.38.38 0 0 0 0-.498c-.332-.344-.672-.673-1.012-1.01a.365.365 0 0 0-.255-.106.32.32 0 0 0-.24.107ZM3.1 7.165l-.997 1.041a.35.35 0 0 0 0 .497l.997.995a.332.332 0 0 0 .382.08.332.332 0 0 0 .112-.08c.348-.33.672-.658 1.012-.995a.35.35 0 0 0 0-.497l-1.012-1.04a.38.38 0 0 0-.494 0ZM13.879 4.87a.357.357 0 0 0-.245.111.35.35 0 0 0-.095.249v1.415a.333.333 0 0 0 .208.318.343.343 0 0 0 .132.027H15.3a.357.357 0 0 0 .249-.1.35.35 0 0 0 .107-.245V5.191a.366.366 0 0 0-.356-.36l-1.421.038ZM5.187 3.34a.357.357 0 0 0-.249.1.35.35 0 0 0-.107.244V5.1a.372.372 0 0 0 .355.36h1.422a.357.357 0 0 0 .244-.112.35.35 0 0 0 .096-.248v-1.4a.343.343 0 0 0-.099-.241.35.35 0 0 0-.24-.104L5.186 3.34Zm5.107-1.232-.99.995a.35.35 0 0 0 0 .497l.99 1.01a.365.365 0 0 0 .51 0c.332-.329.664-.658.996-1.01a.35.35 0 0 0 0-.497l-.996-.995a.365.365 0 0 0-.395-.081.325.325 0 0 0-.115.081Z"
        mask="url(#a)"
      />
    </Svg>,
    {
      css,
      config,
    }
  );

  // Assert that the component was rendered with the correct props
  expect(screen.getByTestId(testID).props.fill).toStrictEqual(
    "rgba(239, 68, 68, 1)"
  );
});
